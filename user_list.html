<!DOCTYPE html>
{% extends 'base.html' %}
{% load widget_tweaks %}
{% block content %}


<head>

  <!-- this is required for search  -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jszip-2.5.0/dt-1.10.23/af-2.3.5/b-1.6.5/b-colvis-1.6.5/b-html5-1.6.5/b-print-1.6.5/cr-1.5.3/fc-3.3.2/kt-2.5.3/r-2.2.6/rg-1.1.2/rr-1.2.7/sl-1.3.1/datatables.min.css"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>


<!-- JavaScripts -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-toggle/2.2.1/js/bootstrap-toggle.min.js"></script>

 <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css">
 <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.6.5/css/buttons.dataTables.min.css">


 <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.5/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.html5.min.js" ></script>
<script src="https://cdn.datatables.net/buttons/1.6.5/js/buttons.print.min.js"></script>




 <!-- Datatables -->
 <script src="https://cdn.datatables.net/1.10.11/js/jquery.dataTables.min.js"></script>
 <script src="https://cdn.datatables.net/1.10.11/js/dataTables.bootstrap.min.js"></script>
 <script src="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.min.css" charset="utf-8"></script>



  <script>
  $(document).ready(function() {
  $('#datatable_id').DataTable( {
    // dom: 'Bfrtip',
    // buttons: [
    //     'copyHtml5', 'csvHtml5', 'excelHtml5', 'pdfHtml5'
    //     ]
} );
} );




  </script>

  <style>




table {
  width: 100%
}

table, th, td
{
  border: 1px solid #005277;
}
th
{
  background: blue;
  color: black;
  position: sticky;
  top: 0;
  box-sizing: border-box;
}
tr th:nth-child(n)
{
  background: #aaaaaa;
}

  </style>



<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8">




  <!-- this is required for datatables-paging-selector -->
<script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>

<script src="https://cdn.datatables.net/plug-ins/1.10.22/api/sum().js"></script>

  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" type='text/javascript'></script> -->


  <script>





//
//     $('.form-group').ready(function(){
//
//       var Dieseltotal = 0;
//       $('td:nth-child(8)').each(function(){
//         var Diesel = $(this).html();
//         if($.isNumeric(Diesel)){
//           Dieseltotal += parseInt(Diesel);
//         }
//       });
//       $('#Dieselresult').text(Dieseltotal);
//     });
//
//
//     $('.form-group').ready(function(){
//
//       var Foodtotal = 0;
//       $('td:nth-child(7)').each(function(){
//         var Food = $(this).html();
//         if($.isNumeric(Food)){
//           Foodtotal += parseInt(Food);
//         }
//       });
//       $('#Foodresult').text(Foodtotal);
//     });
//
//     $('.form-group').ready(function(){
//
//       var Tolltotal = 0;
//       $('td:nth-child(6)').each(function(){
//         var Toll = $(this).html();
//         if($.isNumeric(Toll)){
//           Tolltotal += parseInt(Toll);
//         }
//       });
//       $('#Tollresult').text(Tolltotal);
//     });
//
//     $('.form-group').ready(function(){
//
//       var Maintenancetotal = 0;
//       $('td:nth-child(9)').each(function(){
//         var Maintenance = $(this).html();
//         if($.isNumeric(Maintenance)){
//           Maintenancetotal += parseInt(Maintenance);
//         }
//       });
//       $('#Maintenanceresult').text(Maintenancetotal);
//     });
//
//
//     $('.form-group').ready(function(){
//
//       var Permittotal = 0;
//       $('td:nth-child(10)').each(function(){
//         var Permit = $(this).html();
//         if($.isNumeric(Permit)){
//           Permittotal += parseInt(Permit);
//         }
//       });
//       $('#Permitresult').text(Permittotal);
//     });
//
//
//     $('.form-group').ready(function(){
//
//       var Insurancetotal = 0;
//       $('td:nth-child(11)').each(function(){
//         var Insurance = $(this).html();
//         if($.isNumeric(Insurance)){
//           Insurancetotal += parseInt(Insurance);
//         }
//       });
//       $('#Insuranceresult').text(Insurancetotal);
//     });
//
//     $('.form-group').ready(function(){
//
//       var Invoice_detailstotal = 0;
//       $('td:nth-child(13)').each(function(){
//         var Invoice_details = $(this).html();
//         if($.isNumeric(Invoice_details)){
//           Invoice_detailstotal += parseInt(Invoice_details);
//         }
//       });
//       $('#Invoice_detailsresult').text(Invoice_detailstotal);
//     });
//
//
//
//       $(document).ready(function(){
//
//           // Select all the rows in the table
//           // and get the count of the selected elements
//           var rowCount = $("#datatable_id tr").length;
//           //alert(rowCount-2);
//           rowcount1 = rowCount-2;
//          // console.log(rowCount);
//
//       });
//
//
//
//
//
$(document).ready(function(){
  $('tr').each(function(){
    var CostPerKmtotal=0;
    var difference = 0;
    $(this).find('.subjects').each(function(){
      var total = $(this).text();
      if(total.value!==0 || total.value===0)
      {
        CostPerKmtotal+=parseFloat(total);
      }

    });

    $(this).find('.diff').each(function(){
      console.log($(this).html());

    });
    difference = parseFloat($(this).find(".diff2").html()) - parseFloat($(this).find(".diff1").html());
    //console.log($(this).html(difference));

    $(this).find('#CostPerKmresult').html(Math.abs(CostPerKmtotal/difference).toFixed(2));
    // $('#CostPerKmresultTotal').text(CostPerKmtotal/rowcount1);


  });
  // var value = (CostPerKmtotal/rowcount1);
  // alert(value);
});
//
//
//
// $('.form-group').ready(function(){
//
//   var CostPerKmtotalfinal = 0;
//   $('td:nth-child(12)').each(function(){
//     var CostPerKm = $(this).html();
//     if($.isNumeric(CostPerKm)){
//       CostPerKmtotalfinal += parseFloat(CostPerKm);
//     }
//   });
//   // $('#CostPerKmtotalresult').text(CostPerKmtotalfinal);
//   $(this).find('#CostPerKmtotalresult').html(Math.abs(CostPerKmtotalfinal/rowcount1).toFixed(2));
// });
//
//
//
//
//
//
//
// $(document).ready(function() {
//     $('#bootstrapdatatable').DataTable();
// } );
//
//
// // $('.form-group').ready(function(){
// // $('#Invoice_detailsresult').DataTable( {
// //   drawCallback: function () {
// //     var api = this.api();
// //     $( api.table().footer() ).html(
// //       api.column( 13, {page:'current'} ).data().sum()
// //     );
// //   }
// // } );
// // });
//
// // $('.form-group').ready(function(){
// //
// //   var Invoice_detailstotal = 0;
// //   $('td:nth-child(13)').each(function(){
// //     var Invoice_details = $(this).html();
// //     if($.isNumeric(Invoice_details)){
// //       Invoice_detailstotal += parseInt(Invoice_details);
// //     }
// //   });
// //   $('#Invoice_detailsresult').text(Invoice_detailstotal);
// // });
//
//



$(document).ready(function() {
    $('#datatable_id1').DataTable( {
        "footerCallback": function ( row, data, start, end, display ) {
            var api = this.api(), data;

            // Remove the formatting to get integer data for summation
            var intVal = function ( i ) {
                return typeof i === 'string' ?
                    i.replace(/[\$,]/g, '')*1 :
                    typeof i === 'number' ?
                        i : 0;
            };

            // Total over all pages
            total = api
                .column( 6 )
                .data()
                .reduce( function (a, b) {
                    return intVal(a) + intVal(b);
                }, 0 );

            // Total over this page
            pageTotal = api
                .column( 6, { page: 'current'} )
                .data()
                .reduce( function (a, b) {
                    return intVal(a) + intVal(b);
                }, 0 );

            // Update footer
            $( api.column( 6 ).footer() ).html(
                '$'+pageTotal +' ( $'+ total +' total)'
            );
        }
    } );
} );


  </script>
</head>



  <form method="get">

      <h4 style="margin-top: 0"></h4>
      <div class="content">
    		{% if user.is_authenticated %}
      <!-- <div class="row">
        <div class="form-group col-sm-4 col-md-3">
          {{ filter.form.Name.label_tag }}
          {% render_field filter.form.Name class="form-control" %}
        </div>
        <div class="form-group col-sm-4 col-md-3">
          {{ filter.form.Date.label_tag }}
          {% render_field filter.form.Date class="form-control" %}
        </div>
        <div class="form-group col-sm-4 col-md-3">
          {{ filter.form.Vehicle.label_tag }}
          {% render_field filter.form.Vehicle class="form-control" %}
        </div>
        </div>

      <button type="submit" class="btn btn-primary my-4" >
        <span class="glyphicon glyphicon-search"></span> Search
      </button> -->

<!-- <a id="link" href="{% url 'leadlogisticsApp:deleteview'   %}"><button type="button" class="btn btn-warning" name="Next">delete entries</button></a> -->

        <br>






      {% endif %}
    </div>
  </form>

  <div class="col-md-12">

    <br>
   <span><a href="{% url 'leadlogisticsApp:AddNewrecord' %}" class="btn btn-primary">Add New Record</a></span>
     <a id="link" href="{% url 'leadlogisticsApp:csv' %}"><button type="button" class="btn btn-primary" name="Next">Click here to export data</button></a>
   <br>
   <br>
<!-- <div class="dataTables_length" id="example_length">
  <label>
"Show"
<select class="" name="example_length" aria-controls="example">
  <option value="10">10</option>
  <option value="10">25</option>
  <option value="10">50</option>
  <option value="10">100</option>

</select>
"entries"

  </label>

</div> -->

  <div class="" >

      <table  id="datatable_id" class="table " >
              <thead>
                <tr>
                  <div class="table-box">


                  <!-- <th><input type="checkbox" id="checkall" /></th> -->
                  <th class="sorting_asc"  tabindex="0">name</th>
                  <th class="sorting  header">Vehicle</th>
                  <th class="sorting ">date</th>
                  <th class="sorting">start_km</th>
                  <th class="sorting">end_km</th>
                  <th class="sorting">Toll</th>
                  <th class="sorting">Food</th>
                  <th class="sorting">Diesel</th>
                  <th class="sorting">Maintenance</th>
                  <th class="sorting">Permit</th>
                  <th class="sorting">Insurance</th>
                  <th class="sorting">CostPerKm</th>
                  <th class="sorting">Invoice_details</th>
                  <th class="sorting">Vendorname</th>
                  <th></th>
                  <th></th>
                  </div>
                </tr>
               </thead>
     <tbody>
       {% for data in object_list %}
         <tr>
           <!-- <td><input type="checkbox" class="checkthis" /></td> -->
           <td  <a href="{{ data.id}}"></a> {{ data.Name }}</td>
           <td>{{ data.Vehicle }}</td>
           <td>{{ data.Date }}</td>
           <td class="diff1">{{ data.Start_km}}</td>
           <td class="diff2">{{ data.End_km}}</td>
           <td class="subjects">{{ data.Toll}}</td>
           <td class="subjects">{{ data.Food}}</td>
           <td class="subjects">{{ data.Diesel}}</td>
           <td class="subjects">{{ data.Maintenance}}</td>
           <td class="subjects">{{ data.Permit}}</td>
           <td class="subjects">{{ data.Insurance }}</td>
           <td id ="CostPerKmresult"></td>
           <td>{{ data.Invoice_details }}</td>
           <td>{{ data.Vendorname }}</td>
           <td><p data-placement="top" data-toggle="tooltip" title="Edit"><a href="{% url 'leadlogisticsApp:edit' id=data.id %}" class="btn btn-primary"   >Edit<span class="glyphicon glyphicon-pencil"></span></a></p></td>
           <td><p data-placement="top" data-toggle="tooltip" title="Delete"><a href="{% url 'leadlogisticsApp:delete' pk=data.pk %}"  class="btn btn-danger" >Delete<span class="glyphicon glyphicon-trash"></span></a></p></td>
      </tr>
      {% empty %}
        <tr>

          <!-- <td colspan="14">No data</td> -->
        </tr>
     {% endfor %}
     </tbody>
     <tfoot>

       <tr>

         <td > Total </td>
         <td ></td>
         <td ></td>
         <td ></td>
         <td ></td>
         <td colspan="1" id ="Tollresult"></td>
         <td colspan="1" id ="Foodresult"></td>
         <td colspan="1" id ="Dieselresult"></td>
         <td colspan="1" id ="Maintenanceresult"></td>
         <td colspan="1" id ="Permitresult"></td>
         <td colspan="1" id = "Insuranceresult"></td>
         <td></td>
         <td colspan="1" id = "Invoice_detailsresult"></td>
         <td ></td>
         <td ></td>
         <td ></td>

       </tr>

</tfoot>
    </table>

</div>
</div>

<br>
<br>
<!--
  {% if is_paginated %}
    <div class="row">
      <div class="col-md-12">
        <div>
          {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}"><span class="pg-arrow_left">  <button type="button"  class="btn btn-warning" name="Previous"> Previous</button> </span></a>
          {% endif %}

          <span class="small">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>

          {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}"><span class="pg-arrow_right">   <button type="button" class="btn btn-warning" name="Next">Next</button> </span></a>
          {% endif %}
        </div>
      </div>
    </div>

    <br>
    <br>
    <br>

  {% endif %} -->
{% endblock %}
